<!doctype html><html lang=en><head><meta http-equiv=refresh content="0; url=https://forge.rust-lang.org/compiler/index.html"></head><body><input type=checkbox style=display:none id=menu-control><main class="flex container"><aside class="book-menu fixed"><nav><h2 class=book-brand><a href=https://rust-lang.github.io/compiler-team/>Rust Lang - Compiler Team</a></h2><style>nav ul a[href$=\2f compiler-team\2fminutes\2ftriage-meeting\2fT-compiler-Meeting-Agenda-2023-07-27\2f ]{color:#004ed0}</style><ul><li><p><strong>About</strong></p><ul><li><a href=/compiler-team/about/CODE_OF_CONDUCT/>Code of Conduct</a></li><li><a href=/compiler-team/about/chat-platform/>Chat Platform</a></li><li><a href=/compiler-team/about/steering-meeting/>Steering Meeting</a></li><li><a href=/compiler-team/about/triage-meeting/>Triage Meeting</a></li></ul></li><li><p><strong>Minutes</strong></p><ul><li><a href=/compiler-team/minutes/design-meeting/>Design Meetings</a></li><li><a href=/compiler-team/minutes/steering-meeting/>Steering Meetings</a></li><li><a href=/compiler-team/minutes/triage-meeting/>Triage Meetings</a></li></ul></li><li><p><strong>Procedures</strong></p><ul><li><a href=/compiler-team/procedures/>Documentation</a></li><li><a href=/compiler-team/procedures/crates/>Crates</a></li><li><a href=/compiler-team/procedures/call-for-participation/>Call for participation</a></li><li><a href=/compiler-team/procedures/form-new-working-group/>Form new working group</a></li></ul></li><li><p><a href=/compiler-team/working-groups/><strong>Working Groups</strong></a></p><ul><li><a href=/compiler-team/working-groups/async-await/>Async Await</a></li><li><a href=/compiler-team/working-groups/debugging/>Debugging</a></li><li><a href=/compiler-team/working-groups/diagnostics/>Diagnostics</a></li><li><a href=/compiler-team/working-groups/rustc-dev-guide/>Rustc Dev Guide</a></li><li><a href=/compiler-team/working-groups/llvm/>LLVM</a></li><li><a href=/compiler-team/working-groups/meta/>Meta</a></li><li><a href=/compiler-team/working-groups/mir-opt/>MIR-opt</a></li><li><a href=/compiler-team/working-groups/nll/>NLL</a></li><li><a href=/compiler-team/working-groups/parallel-rustc/>parallel rustc</a></li><li><a href=/compiler-team/working-groups/pgo/>PGO</a></li><li><a href=/compiler-team/working-groups/pipelining/>pipelining</a></li><li><a href=/compiler-team/working-groups/polonius/>polonius</a></li><li><a href=/compiler-team/working-groups/polymorphization/>polymorphization</a></li><li><a href=/compiler-team/working-groups/prioritization/>Prioritization</a></li><li><a href=/compiler-team/working-groups/rfc-2229/>rfc-2229</a></li><li><a href=/compiler-team/working-groups/rls-2.0/>rls-2.0</a></li><li><a href=/compiler-team/working-groups/self-profile/>Self Profile</a></li><li><a href=/compiler-team/working-groups/traits/>Traits</a></li></ul></li></ul></nav></aside><div class=book-page><header class="align-center justify-between book-header"><label for=menu-control><img src=/compiler-team/svg/menu.svg alt=Menu>
</label><strong>T Compiler Meeting Agenda 2023 07 27</strong></header><article class=markdown><h1 id=t-compiler-meeting-agenda-2023-07-27>T-compiler Meeting Agenda 2023-07-27</h1><h2 id=announcements>Announcements</h2><ul><li>A Rust release 1.71.1 is scheduled for August, 3rd (<a href=https://github.com/rust-lang/rust/pull/111516#issuecomment-1650656406>comment</a>)<ul><li>stable backports this week are targeting this point release</li><li>for reference, next stable 1.72.0 is planned for <a href=time:2023-08-24T14:00:00+02:00>time:2023-08-24T14:00:00+02:00</a></li></ul></li><li><a href="https://www.google.com/calendar/event?eid=MDJyYnJ1cGFtdWR1c2lnNjFmcHJ2b3JlODFfMjAyMzA3MjhUMTQwMDAwWiA2dTVycnRjZTZscnR2MDdwZmkzZGFtZ2p1c0Bn">Compiler Team Planning meeting</a> at <a href=time:2023-07-28T10:00:00-04:00>time:2023-07-28T10:00:00-04:00</a></li><li>An interesting <a href=https://rust-lang.zulipchat.com/#narrow/stream/241545-t-release/topic/Edition.20target.20date>Zulip thread</a> about a possible date for a 2024 edition<ul><li>Spoiler: could be around Nov, 28th 2024 (Rust ~1.83.0)</li></ul></li><li>Reminder: if you see a PR/issue that seems like there might be legal implications due to copyright/IP/etc, please let the Core team know (or at least message @<em><strong>pnkfelix</strong> or @</em><strong>Wesley Wiser</strong> so we can pass it along).</li></ul><h3 id=other-wg-meetings-calendar-linkhttpscalendargooglecomcalendarembedsrc6u5rrtce6lrtv07pfi3damgjus40groupcalendargooglecom>Other WG meetings (<a href="https://calendar.google.com/calendar/embed?src=6u5rrtce6lrtv07pfi3damgjus%40group.calendar.google.com">calendar link</a>)</h3><ul><li><a href="https://www.google.com/calendar/event?eid=N2VsaWszdm9rY3NhdDF1MjdyMjVqajNpcWVfMjAyMzA3MjdUMjAwMDAwWiA2dTVycnRjZTZscnR2MDdwZmkzZGFtZ2p1c0Bn">AFIT/RPITIT Impl Triage</a> at <a href=time:2023-07-27T16:00:00-04:00>time:2023-07-27T16:00:00-04:00</a></li><li><a href="https://www.google.com/calendar/event?eid=MTg3MDhpdTc3YXBqMGMzbnNxanUwdWZnazhfMjAyMzA3MzFUMTQwMDAwWiA2dTVycnRjZTZscnR2MDdwZmkzZGFtZ2p1c0Bn">Types team meeting: RPITIT refactor</a> at <a href=time:2023-07-31T10:00:00-04:00>time:2023-07-31T10:00:00-04:00</a></li></ul><h2 id=mcpsfcps>MCPs/FCPs</h2><ul><li>New MCPs (take a look, see if you like them!)<ul><li>No new proposals this time.</li></ul></li><li>Old MCPs (stale MCP might be closed as per <a href=https://forge.rust-lang.org/compiler/mcp.html#when-should-major-change-proposals-be-closed>MCP procedure</a>)<ul><li>None at this time</li></ul></li><li>Old MCPs (not seconded, take a look)<ul><li>&ldquo;Cell Broadband Engine SPU support&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/614>compiler-team#614</a>(last review activity: 3 months ago)</li><li>&ldquo;Add support for Zephyr OS&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/629>compiler-team#629</a>(last review activity: about 35 days ago)</li><li>&ldquo;Consistently use &ldquo;region&rdquo; terminology in later stages of the compiler&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/634>compiler-team#634</a>(last review activity: 2 months ago)</li><li>&ldquo;Add a new <code>--build-id</code> flag to rustc&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/635>compiler-team#635</a>(last review activity: 2 months ago)</li><li>&ldquo;Simplify and improve explicitness of the check-cfg syntax&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/636>compiler-team#636</a>(last review activity: about 42 days ago)</li><li>&ldquo;Add support for visionOS targets&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/642>compiler-team#642</a>(last review activity: about 27 days ago)</li><li>&ldquo;Add illumos Tier3 targets&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/644>compiler-team#644</a>(last review activity: about 2 days ago)</li><li>&ldquo;Migrate away from u32 as an offset/length type&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/647>compiler-team#647</a>(last review activity: about 20 days ago)</li></ul></li><li>Pending FCP requests (check your boxes!)<ul><li>&ldquo;Retire the mailing list and make all decisions on zulip&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/649>compiler-team#649</a><ul><li>Note: pending 2 concerns</li></ul></li><li>&ldquo;Support overriding <code>warnings</code> level for a specific lint via command line&rdquo; <a href=https://github.com/rust-lang/rust/pull/113307>rust#113307</a></li></ul></li><li>Things in FCP (make sure you&rsquo;re good with it)<ul><li>&ldquo;Revise error code documentation standard&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/615>compiler-team#615</a></li><li>&ldquo;Add a blanket flag to enable/disable codegen UB checks&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/625>compiler-team#625</a></li><li>&ldquo;Report all lints, even if other errors already occurred.&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/633>compiler-team#633</a></li><li>&ldquo;[MCP] proposing a macros working group&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/637>compiler-team#637</a></li><li>&ldquo;Drop MIPS to tier 3&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/648>compiler-team#648</a></li><li>&ldquo;Disallow non-identifier-valid &ndash;extern crate names " <a href=https://github.com/rust-lang/compiler-team/issues/650>compiler-team#650</a></li><li>&ldquo;Windows support schedule 2024&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/651>compiler-team#651</a></li><li>&ldquo;New tier-3 targets for TEEOS&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/652>compiler-team#652</a></li><li>&ldquo;Add option to pass environment variables&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/653>compiler-team#653</a></li><li>&ldquo;Amend target policy to require codegen support&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/655>compiler-team#655</a></li><li>&ldquo;Expose default_hidden_visibility as a rustc command line option&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/656>compiler-team#656</a></li><li>&ldquo;Add tidy rule against <code>issue-[0-9]+.rs</code> tests&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/658>compiler-team#658</a><ul><li>in nominated issues section: @<strong>pnkfelix</strong> suggests a quick discussion (see <a href=https://rust-lang.zulipchat.com/#narrow/stream/233931-t-compiler.2Fmajor-changes/topic/Add.20tidy.20rule.20against.20.60issue-.5B0-9.5D.2B.2Ers.60.20t.E2.80.A6.20compiler-team.23658>comment</a>)</li></ul></li></ul></li><li>Accepted MCPs<ul><li>&ldquo;Use <code>FieldIdx</code> all the way down&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/639>compiler-team#639</a></li><li>&ldquo;Add support for the riscv64-linux-android target&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/640>compiler-team#640</a></li><li>&ldquo;Implement alignment and size niches for references&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/641>compiler-team#641</a></li><li>&ldquo;Changes to StatementKind::Coverage&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/645>compiler-team#645</a></li><li>&ldquo;KRabcake SANitization (KRSAN) mode&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/646>compiler-team#646</a></li></ul></li><li>Finalized FCPs (disposition merge)<ul><li>&ldquo;Add documentation on v0 symbol mangling.&rdquo; <a href=https://github.com/rust-lang/rust/pull/97571>rust#97571</a></li><li>&ldquo;Support interpolated block for <code>try</code> and <code>async</code>&rdquo; <a href=https://github.com/rust-lang/rust/pull/112953>rust#112953</a></li></ul></li></ul><h3 id=wg-checkins>WG checkins</h3><ul><li><p>Types team by @<strong>nikomatsakis</strong> and @<strong>Jack Huey</strong> (<a href=https://hackmd.io/dPMI9IZqR0uzp4fuZVr4lg#WG-checkins>previous checkin</a>)</p><blockquote><ul><li>Trait system refactor blog post: <a href=https://blog.rust-lang.org/inside-rust/2023/07/17/trait-system-refactor-initiative.html>https://blog.rust-lang.org/inside-rust/2023/07/17/trait-system-refactor-initiative.html</a></li><li>We have started recurring &ldquo;solver&rdquo; meetings on Mondays after our full types team meetings</li><li>Crater run for using new trait solver for coherence went really well (<a href=https://github.com/rust-lang/rust/pull/113895>https://github.com/rust-lang/rust/pull/113895</a>)</li></ul></blockquote></li><li><p>@_<em>WG-mir-opt</em> by @<strong>oli</strong> (<a href=https://hackmd.io/auk0MATiScWFokXL6RlO-w#WG-checkins>previous checkin</a>)</p><blockquote><ul><li>SMIR now supports all TyKind variants</li></ul></blockquote></li></ul><h2 id=backport-nominations>Backport nominations</h2><p><a href="https://github.com/rust-lang/rust/issues?q=is%3Aall+label%3Abeta-nominated+-label%3Abeta-accepted+label%3AT-compiler">T-compiler stable</a> / <a href="https://github.com/rust-lang/rust/issues?q=is%3Aall+label%3Astable-nominated+-label%3Astable-accepted+label%3AT-compiler">T-compiler beta</a></p><ul><li>:beta: [1.72.0] &ldquo;lint/ctypes: fix <code>()</code> return type checks&rdquo; <a href=https://github.com/rust-lang/rust/pull/113457>rust#113457</a><ul><li>Fixes #113436, a warn-by-default after <a href=https://github.com/rust-lang/rust/issues/113436#issuecomment-1640756721>T-libs decision</a> to proceed</li><li>perf run indicates neutral changes</li></ul></li></ul><ul><li>:beta: [1.72.0] &ldquo;Substitute types before checking inlining compatibility.&rdquo; <a href=https://github.com/rust-lang/rust/pull/113802>rust#113802</a><ul><li>Fixes #112332 and #113781, two ICEs (one dupe of the other, btw), one affecting a old version of a real-world crate (updated since then)</li><li>Also nominated for stable backport</li></ul></li></ul><ul><li>:stable: [1.71.1] &ldquo;Don&rsquo;t use <code>can_eq</code> in <code>derive(..)</code> suggestion for missing method&rdquo; <a href=https://github.com/rust-lang/rust/pull/111516>rust#111516</a><ul><li>Fixes regression #111500, ICE on invalid code but reported also on sibling issues #114049 and 114056</li></ul></li></ul><ul><li>:stable: [1.71.1] &ldquo;<code>suspicious_double_ref_op</code>: don&rsquo;t lint on <code>.borrow()</code>&rdquo; <a href=https://github.com/rust-lang/rust/pull/112517>rust#112517</a><ul><li>Fixes #112489, P-medium diag regression</li></ul></li></ul><ul><li>:stable: [1.71.1] &ldquo;Substitute types before checking inlining compatibility.&rdquo; <a href=https://github.com/rust-lang/rust/pull/113802>rust#113802</a></li></ul><h2 id=prs-s-waiting-on-team>PRs S-waiting-on-team</h2><p><a href="https://github.com/rust-lang/rust/pulls?q=is%3Aopen+label%3AS-waiting-on-team+label%3AT-compiler">T-compiler</a></p><ul><li>Other issues <a href=https://hackmd.io/XYr1BrOWSiqCrl8RCWXRaQ>in progress or waiting on other teams</a></li></ul><h2 id=issues-of-note>Issues of Note</h2><h3 id=short-summary>Short Summary</h3><ul><li><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AT-compiler+label%3AP-critical">0 T-compiler P-critical issues</a><ul><li><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AT-compiler+label%3AP-critical+no%3Aassignee">0 of those are unassigned</a></li></ul></li><li><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AT-compiler+label%3AP-high">55 T-compiler P-high issues</a><ul><li><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AT-compiler+label%3AP-high+no%3Aassignee">25 of those are unassigned</a></li></ul></li><li><a href=https://github.com/rust-lang/rust/labels/regression-from-stable-to-beta>0 P-critical, 0 P-high, 3 P-medium, 1 P-low regression-from-stable-to-beta</a></li><li><a href=https://github.com/rust-lang/rust/labels/regression-from-stable-to-nightly>0 P-critical, 0 P-high, 3 P-medium, 2 P-low regression-from-stable-to-nightly</a></li><li><a href=https://github.com/rust-lang/rust/labels/regression-from-stable-to-stable>0 P-critical, 34 P-high, 100 P-medium, 18 P-low regression-from-stable-to-stable</a></li></ul><h3 id=p-critical>P-critical</h3><p><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AP-critical+label%3AT-compiler">T-compiler</a></p><ul><li>No <code>P-critical</code> issues for <code>T-compiler</code> at this time.</li></ul><p><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AP-critical+label%3AT-types">T-types</a></p><ul><li>No <code>P-critical</code> issues for <code>T-types</code> at this time.</li></ul><p><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AP-critical+label%3AT-rustdoc">T-rustdoc</a></p><ul><li>No <code>P-critical</code> issues for <code>T-rustdoc</code> at this time.</li></ul><h3 id=p-high-regressions>P-high regressions</h3><p><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3Aregression-from-stable-to-beta+label%3AP-high+-label%3AT-infra+-label%3AT-libs+-label%3AT-libs-api+-label%3AT-release+-label%3AT-rustdoc+-label%3AT-core">P-high beta regressions</a></p><ul><li>No <code>P-high</code> beta regressions this time.</li></ul><p><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3Aregression-from-stable-to-nightly+label%3AP-high+no%3Aassignee+-label%3AT-infra+-label%3AT-libs+-label%3AT-libs-api+-label%3AT-release+-label%3AT-rustdoc+-label%3AT-core+">Unassigned P-high nightly regressions</a></p><ul><li>No unassigned <code>P-high</code> nightly regressions this time.</li></ul><h2 id=performance-logs>Performance logs</h2><p><a href=https://github.com/rust-lang/rustc-perf/blob/master/triage/2023-07-26.md>Triage logs for 2023-07-26</a></p><p>A relatively light week with respect to performance changes. The one major
regressing PR was reverted (for other reasons), and we saw some very nice gains
on compile-times from (1.) changes to our codegen-unit merging logic and from
(2.) changes to the stdlib slice iterators encoding its non-null guarantees
directly, allowing the removal of a call to the <code>assume</code> intrinsic.</p><p>Triage done by <strong>@pnkfelix</strong>.
Revision range: <a href="https://perf.rust-lang.org/?start=6b9236ed5a58879969ddcf4c35a6a24f6260e979&amp;end=0308df23e621e783e31a27ca5beaa01b9df60d4a&amp;absolute=false&amp;stat=instructions%3Au">6b9236ed..0308df23</a></p><p><strong>Summary</strong>:</p><table><thead><tr><th style=text-align:center>(instructions:u)</th><th style=text-align:center>mean</th><th style=text-align:center>range</th><th style=text-align:center>count</th></tr></thead><tbody><tr><td style=text-align:center>Regressions (primary)</td><td style=text-align:center>1.4%</td><td style=text-align:center>[0.6%, 10.2%]</td><td style=text-align:center>27</td></tr><tr><td style=text-align:center>Regressions (secondary)</td><td style=text-align:center>1.1%</td><td style=text-align:center>[0.3%, 2.9%]</td><td style=text-align:center>19</td></tr><tr><td style=text-align:center>Improvements (primary)</td><td style=text-align:center>-2.2%</td><td style=text-align:center>[-8.3%, -0.4%]</td><td style=text-align:center>21</td></tr><tr><td style=text-align:center>Improvements (secondary)</td><td style=text-align:center>-1.6%</td><td style=text-align:center>[-2.0%, -1.2%]</td><td style=text-align:center>2</td></tr><tr><td style=text-align:center>All (primary)</td><td style=text-align:center>-0.2%</td><td style=text-align:center>[-8.3%, 10.2%]</td><td style=text-align:center>48</td></tr></tbody></table><p>1 Regressions, 1 Improvements, 4 Mixed; 1 of them in rollups
30 Untriaged Pull Requests
35 artifact comparisons made in total</p><h4 id=regressions>Regressions</h4><p>Prototype: Add unstable <code>-Z reference-niches</code> option <a href=https://github.com/rust-lang/rust/pull/113166>#113166</a> <a href="https://perf.rust-lang.org/compare.html?start=1e6c09a803fd543a98bfbe1624d697a55300a786&amp;end=557359f92512ca88b62a602ebda291f17a953002&amp;stat=instructions:u">(Comparison Link)</a></p><table><thead><tr><th style=text-align:center>(instructions:u)</th><th style=text-align:center>mean</th><th style=text-align:center>range</th><th style=text-align:center>count</th></tr></thead><tbody><tr><td style=text-align:center>Regressions (primary)</td><td style=text-align:center>0.7%</td><td style=text-align:center>[0.3%, 1.1%]</td><td style=text-align:center>19</td></tr><tr><td style=text-align:center>Regressions (secondary)</td><td style=text-align:center>1.0%</td><td style=text-align:center>[0.3%, 1.2%]</td><td style=text-align:center>4</td></tr><tr><td style=text-align:center>Improvements (primary)</td><td style=text-align:center>-</td><td style=text-align:center>-</td><td style=text-align:center>0</td></tr><tr><td style=text-align:center>Improvements (secondary)</td><td style=text-align:center>-</td><td style=text-align:center>-</td><td style=text-align:center>0</td></tr><tr><td style=text-align:center>All (primary)</td><td style=text-align:center>0.7%</td><td style=text-align:center>[0.3%, 1.1%]</td><td style=text-align:center>19</td></tr></tbody></table><ul><li>reverted in PR #113946</li><li>marked as triaged</li></ul><h4 id=improvements>Improvements</h4><p>Inline overlap based CGU merging <a href=https://github.com/rust-lang/rust/pull/113777>#113777</a> <a href="https://perf.rust-lang.org/compare.html?start=903e279f468590fa3425f8aff7f3d61a5a873dbb&amp;end=0d6a9b2bf7f823ed563ca3a75392ba9bf9ff1566&amp;stat=instructions:u">(Comparison Link)</a></p><table><thead><tr><th style=text-align:center>(instructions:u)</th><th style=text-align:center>mean</th><th style=text-align:center>range</th><th style=text-align:center>count</th></tr></thead><tbody><tr><td style=text-align:center>Regressions (primary)</td><td style=text-align:center>1.2%</td><td style=text-align:center>[1.2%, 1.2%]</td><td style=text-align:center>1</td></tr><tr><td style=text-align:center>Regressions (secondary)</td><td style=text-align:center>-</td><td style=text-align:center>-</td><td style=text-align:center>0</td></tr><tr><td style=text-align:center>Improvements (primary)</td><td style=text-align:center>-1.8%</td><td style=text-align:center>[-4.5%, -0.3%]</td><td style=text-align:center>11</td></tr><tr><td style=text-align:center>Improvements (secondary)</td><td style=text-align:center>-</td><td style=text-align:center>-</td><td style=text-align:center>0</td></tr><tr><td style=text-align:center>All (primary)</td><td style=text-align:center>-1.6%</td><td style=text-align:center>[-4.5%, 1.2%]</td><td style=text-align:center>12</td></tr></tbody></table><p>this improved instruction-counts for 9 opt-full primary benchmarks. (The one regression was to regex-1.5.5 opt-full, by -1.15%; but the wins elsewhere pay for this.)</p><p>As noted by @nnethercote , this results in nearly 10second reduction in bootstrap time (i.e. -1.495%, no small feat at all!)</p><h4 id=mixed>Mixed</h4><p>Turn copy into moves during DSE. <a href=https://github.com/rust-lang/rust/pull/113758>#113758</a> <a href="https://perf.rust-lang.org/compare.html?start=6b53175b5d8558b69f5f46ce969fe42fb457e01b&amp;end=06a53ddc0bd3a50f9bcf2f7c373011dc7869f59f&amp;stat=instructions:u">(Comparison Link)</a></p><table><thead><tr><th style=text-align:center>(instructions:u)</th><th style=text-align:center>mean</th><th style=text-align:center>range</th><th style=text-align:center>count</th></tr></thead><tbody><tr><td style=text-align:center>Regressions (primary)</td><td style=text-align:center>9.4%</td><td style=text-align:center>[9.4%, 9.4%]</td><td style=text-align:center>1</td></tr><tr><td style=text-align:center>Regressions (secondary)</td><td style=text-align:center>0.6%</td><td style=text-align:center>[0.6%, 0.6%]</td><td style=text-align:center>1</td></tr><tr><td style=text-align:center>Improvements (primary)</td><td style=text-align:center>-1.0%</td><td style=text-align:center>[-2.1%, -0.2%]</td><td style=text-align:center>14</td></tr><tr><td style=text-align:center>Improvements (secondary)</td><td style=text-align:center>-0.8%</td><td style=text-align:center>[-1.3%, -0.2%]</td><td style=text-align:center>2</td></tr><tr><td style=text-align:center>All (primary)</td><td style=text-align:center>-0.3%</td><td style=text-align:center>[-2.1%, 9.4%]</td><td style=text-align:center>15</td></tr></tbody></table><ul><li>regression is to webrender-2022 opt incr-patched, (by 9.4%, as you can see from the above)</li><li>from the flamegraphs, seems like <code>codegen_module_perform_lto</code> went from 8.6 seconds to 9.6 seconds, with half of the growth in <code>LLVM_lto_optimize</code>, and half in <code>LLVM_module_codegen_emit_obj</code>.</li><li>not marking as triaged for now.</li></ul><p>Rollup of 7 pull requests <a href=https://github.com/rust-lang/rust/pull/113890>#113890</a> <a href="https://perf.rust-lang.org/compare.html?start=06a53ddc0bd3a50f9bcf2f7c373011dc7869f59f&amp;end=092e4f46be168ab24d53e4141086b2cf04822b8e&amp;stat=instructions:u">(Comparison Link)</a></p><table><thead><tr><th style=text-align:center>(instructions:u)</th><th style=text-align:center>mean</th><th style=text-align:center>range</th><th style=text-align:center>count</th></tr></thead><tbody><tr><td style=text-align:center>Regressions (primary)</td><td style=text-align:center>-</td><td style=text-align:center>-</td><td style=text-align:center>0</td></tr><tr><td style=text-align:center>Regressions (secondary)</td><td style=text-align:center>0.2%</td><td style=text-align:center>[0.2%, 0.2%]</td><td style=text-align:center>1</td></tr><tr><td style=text-align:center>Improvements (primary)</td><td style=text-align:center>-0.3%</td><td style=text-align:center>[-0.3%, -0.2%]</td><td style=text-align:center>4</td></tr><tr><td style=text-align:center>Improvements (secondary)</td><td style=text-align:center>-</td><td style=text-align:center>-</td><td style=text-align:center>0</td></tr><tr><td style=text-align:center>All (primary)</td><td style=text-align:center>-0.3%</td><td style=text-align:center>[-0.3%, -0.2%]</td><td style=text-align:center>4</td></tr></tbody></table><ul><li>that doesn&rsquo;t seem worth dissecting</li><li>marking as triaged</li><li>(the specific secondary is tt-muncher check incr-unchanged 0.23%)</li></ul><p>Always const-prop scalars and scalar pairs <a href=https://github.com/rust-lang/rust/pull/113858>#113858</a> <a href="https://perf.rust-lang.org/compare.html?start=399b068235ceea440540539b3bfd1aeb82214a28&amp;end=e2a7ba2771a70439cd546fdae676abe11dacf6f9&amp;stat=instructions:u">(Comparison Link)</a></p><table><thead><tr><th style=text-align:center>(instructions:u)</th><th style=text-align:center>mean</th><th style=text-align:center>range</th><th style=text-align:center>count</th></tr></thead><tbody><tr><td style=text-align:center>Regressions (primary)</td><td style=text-align:center>0.8%</td><td style=text-align:center>[0.3%, 3.3%]</td><td style=text-align:center>42</td></tr><tr><td style=text-align:center>Regressions (secondary)</td><td style=text-align:center>0.7%</td><td style=text-align:center>[0.2%, 1.1%]</td><td style=text-align:center>19</td></tr><tr><td style=text-align:center>Improvements (primary)</td><td style=text-align:center>-0.6%</td><td style=text-align:center>[-1.3%, -0.2%]</td><td style=text-align:center>6</td></tr><tr><td style=text-align:center>Improvements (secondary)</td><td style=text-align:center>-</td><td style=text-align:center>-</td><td style=text-align:center>0</td></tr><tr><td style=text-align:center>All (primary)</td><td style=text-align:center>0.6%</td><td style=text-align:center>[-1.3%, 3.3%]</td><td style=text-align:center>48</td></tr></tbody></table><ul><li>we didn&rsquo;t anticipate such a high impact to the instruction-counts; the trial run said there were two primary regressions here, not 42.<ul><li>exa-0.10.1 opt-full regressed by 3.34%</li><li>five various bitmaps-3.1.0 profiles/scenarios regressed by 1.01% to 1.21%</li><li>ripgrep-13.0.0 check-incr-unchanged regressed by 1.01%</li><li>bunch of others that regressed by a little less than 1%&mldr; seems not great.</li></ul></li><li>not marking as triaged.</li></ul><p>Get <code>!nonnull</code> metadata on slice iterators, without <code>assume</code>s <a href=https://github.com/rust-lang/rust/pull/113344>#113344</a> <a href="https://perf.rust-lang.org/compare.html?start=e2a7ba2771a70439cd546fdae676abe11dacf6f9&amp;end=c720a9cd1280d24838d0f649538dcd0e4352692c&amp;stat=instructions:u">(Comparison Link)</a></p><table><thead><tr><th style=text-align:center>(instructions:u)</th><th style=text-align:center>mean</th><th style=text-align:center>range</th><th style=text-align:center>count</th></tr></thead><tbody><tr><td style=text-align:center>Regressions (primary)</td><td style=text-align:center>8.3%</td><td style=text-align:center>[8.3%, 8.3%]</td><td style=text-align:center>1</td></tr><tr><td style=text-align:center>Regressions (secondary)</td><td style=text-align:center>-</td><td style=text-align:center>-</td><td style=text-align:center>0</td></tr><tr><td style=text-align:center>Improvements (primary)</td><td style=text-align:center>-1.1%</td><td style=text-align:center>[-8.3%, -0.5%]</td><td style=text-align:center>63</td></tr><tr><td style=text-align:center>Improvements (secondary)</td><td style=text-align:center>-0.7%</td><td style=text-align:center>[-1.1%, -0.3%]</td><td style=text-align:center>15</td></tr><tr><td style=text-align:center>All (primary)</td><td style=text-align:center>-1.0%</td><td style=text-align:center>[-8.3%, 8.3%]</td><td style=text-align:center>64</td></tr></tbody></table><ul><li>cranelift-codegen-0.82.1 opt-full regressed by 8.31%</li><li>a slew of other benchmarks improved (regex-1.5.5 incr-patched by -8.28%, bitmaps incr by 1.2-1.4%, the rest by -1% or less)</li><li>overall, a nice win. That&rsquo;s enough to let me mark this as triaged.</li></ul><h2 id=nominated-issues>Nominated Issues</h2><p><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AI-compiler-nominated">T-compiler</a></p><ul><li>&ldquo;MSVC and rustc disagree on minimum stack alignment on x86 Windows&rdquo; <a href=https://github.com/rust-lang/rust/issues/112480>rust#112480</a><ul><li>Discussed in the past 2 meetings (<a href=https://rust-lang.zulipchat.com/#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202023-07-13/near/374961199>here</a> and <a href=https://rust-lang.zulipchat.com/#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202023-07-20/near/377002646>here</a>), left nominated for further discussion (maybe in a separate session)</li></ul></li><li>&ldquo;&ldquo;Legacy&rdquo; tier 2 targets have misplaced or absent maintainer docs&rdquo; <a href=https://github.com/rust-lang/rust/issues/113739>rust#113739</a><ul><li>Discussed in the past meeting (<a href=https://rust-lang.zulipchat.com/#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202023-07-20/near/377013350>here</a>), left nominated for further discussion (maybe in a separate session)</li></ul></li><li>&ldquo;Add tidy rule against <code>issue-[0-9]+.rs</code> tests&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/658>compiler-team#658</a><ul><li>an MCP proposing to remove the issue # from UI tests filename, considered lacking semantic information</li><li>other proposals point to keeping the issue # as it <em>is</em> descriptive of the issue(s), with variations around &ldquo;issue-123456-&rdquo;</li><li>maybe enforcing a descriptive first-line comment in the test file (e.g. <code>// #12345 Fixed redundant streaming problem</code>)</li><li>thoughts from Jack</li></ul></li></ul><blockquote><p>tl;dr There are two things we should discuss: 1) This seems like a process failure and we should think about scheduling a discussion around MCPs (and when waiting the full 10 days is appropriate and when it&rsquo;s unnecessary). 2) Do we like this MCP/PR <em>as-is</em>, is it <em>okay-enough</em> to stay on master until we figure out a <em>better</em> solution, or should we revert?</p></blockquote><blockquote><p>First, it kind of irks me that this was pushed through without waiting for the full 10 days of MCP, and I wonder if there&rsquo;s a discussion to be had about process here. (I&rsquo;m not sure if we reevaluated if MCPs are working or not, etc.) This is clearly the type of PR that MCPs are meant for: changes that have wide-ranging effects on compiler development. The PR itself even got some comments one way or the other, and so does the (now created) MCP zulip thread. AND there was even this note in the PR OP: &ldquo;note: between the creation of this PR and 2023-07-25 (14 days), 10 more tests were added that failed this check.&rdquo; So, people are obviously using this pattern at a high frequency. Really, this should have waited for more visibility before merge.</p></blockquote><blockquote><p>For the actual substance of the PR/MCP, a few thoughts. First, it&rsquo;s not clear to me if something like <code>issue-12345-invalid-fn-name.rs</code> would be allowed or not (doesn&rsquo;t seem like it is, but this seems to have been heavily favored in the comments as <em>a minimum</em> for what should be allowed). Second, it doesn&rsquo;t seem the places/situations where file names like <code>issue-12345.rs</code> actually makes decent sense were even considered: bug tests where we&rsquo;re there&rsquo;s an open issue, issues reported through fuzzing where the actual program is ICE->error, issues that have been fixed since being opened and it&rsquo;s not clear what exactly the problem was. I also think the test naming is evidence of a more subtle pattern: we very often today commit tests as-is from issues. This is maybe okay when there is one issue that a given PR fixes. But, it starts to get interesting when you have a PR that fixes multiple related issues. Now, we&rsquo;re in the dilemma of &ldquo;are these tests similar enough to each other that they should just be only one test file, or could they be triggered separately&rdquo;. This change <em>could</em> help with that, by making it more work to add regression tests exactly, but I&rsquo;m not sure &ldquo;more work&rdquo; is a good solution. (Aside, I don&rsquo;t personally agree that <code>issue-12345.rs</code> doesn&rsquo;t give enough context to what the test is for: it&rsquo;s a regression test from a reported issue).</p></blockquote><ul><li>&ldquo;coverage: Replace <code>ExpressionOperandId</code> with enum <code>Operand</code> <a href=https://github.com/rust-lang/rust/pull/113428>rust#113428</a><ul><li>nominated to help find a reviewer with some context</li></ul></li><li>&ldquo;Support <code>--print KIND=PATH</code> command line syntax by <a href=https://github.com/rust-lang/rust/pull/113780>rust#113780</a><ul><li>Nominated by @<strong>Urgau</strong> (<a href=https://github.com/rust-lang/rust/pull/113780#issuecomment-1646566381>comment</a>): asks if this change shouldn&rsquo;t have gone through some signal boosting / approval procedure before being merged</li></ul></li></ul><p><a href="https://github.com/rust-lang/rfcs/issues?q=is%3Aopen+label%3AI-compiler-nominated">RFC</a></p><ul><li>No I-compiler-nominated RFCs this time.</li></ul><h3 id=oldest-prs-waiting-for-review>Oldest PRs waiting for review</h3><p><a href="https://github.com/rust-lang/rust/pulls?q=is%3Apr+is%3Aopen+sort%3Aupdated-asc+label%3AS-waiting-on-review+draft%3Afalse+label%3AT-compiler">T-compiler</a></p><ul><li>&ldquo;Fix suggestion spans for expr from macro expansions&rdquo; <a href=https://github.com/rust-lang/rust/pull/112043>rust#112043</a> (last review activity: about 28 days ago)<ul><li>cc @<strong>cjgillot</strong></li></ul></li><li>&ldquo;Tait must be constrained if in sig&rdquo; <a href=https://github.com/rust-lang/rust/pull/113169>rust#113169</a> (last review activity: about 27 days ago)<ul><li>cc @<strong>oli</strong> (appointed as self reviewer)</li></ul></li><li>&ldquo;Report allocation errors as panics, second attempt&rdquo; <a href=https://github.com/rust-lang/rust/pull/112331>rust#112331</a> (last review activity: about 26 days ago)<ul><li>cc: @<strong>bjorn3</strong> (though T-libs also in the review loop)</li></ul></li></ul><h2 id=next-weeks-wg-checkins>Next week&rsquo;s WG checkins</h2><ul><li>@_<em>WG-rls2.0</em> by @<strong>Lukas Wirth</strong> (<a href="https://hackmd.io/team/rust-compiler-team?nav=overview">https://hackmd.io/team/rust-compiler-team?nav=overview</a>)</li><li>@_<em>WG-self-profile</em> by @<strong>mw</strong> and @<strong>Wesley Wiser</strong> (<a href="https://hackmd.io/team/rust-compiler-team?nav=overview">https://hackmd.io/team/rust-compiler-team?nav=overview</a>)</li></ul><p>Next agenda draft: <a href=https://hackmd.io/LLdrdTZPT06xMPq9a1gYcQ>https://hackmd.io/LLdrdTZPT06xMPq9a1gYcQ</a></p></article></div><aside class="book-toc level-6 fixed"><nav id=TableOfContents><ul><li><a href=#announcements>Announcements</a><ul><li><a href=#other-wg-meetings-calendar-linkhttpscalendargooglecomcalendarembedsrc6u5rrtce6lrtv07pfi3damgjus40groupcalendargooglecom>Other WG meetings (<a href="https://calendar.google.com/calendar/embed?src=6u5rrtce6lrtv07pfi3damgjus%40group.calendar.google.com">calendar link</a>)</a></li></ul></li><li><a href=#mcpsfcps>MCPs/FCPs</a><ul><li><a href=#wg-checkins>WG checkins</a></li></ul></li><li><a href=#backport-nominations>Backport nominations</a></li><li><a href=#prs-s-waiting-on-team>PRs S-waiting-on-team</a></li><li><a href=#issues-of-note>Issues of Note</a><ul><li><a href=#short-summary>Short Summary</a></li><li><a href=#p-critical>P-critical</a></li><li><a href=#p-high-regressions>P-high regressions</a></li></ul></li><li><a href=#performance-logs>Performance logs</a><ul><li></li></ul></li><li><a href=#nominated-issues>Nominated Issues</a><ul><li><a href=#oldest-prs-waiting-for-review>Oldest PRs waiting for review</a></li></ul></li><li><a href=#next-weeks-wg-checkins>Next week&rsquo;s WG checkins</a></li></ul></nav></aside></main></body></html>