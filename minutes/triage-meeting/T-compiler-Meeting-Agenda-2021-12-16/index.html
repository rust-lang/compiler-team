<!doctype html><html lang=en><head><meta http-equiv=refresh content="0; url=https://forge.rust-lang.org/compiler/index.html"></head><body><input type=checkbox style=display:none id=menu-control><main class="flex container"><aside class="book-menu fixed"><nav><h2 class=book-brand><a href=https://rust-lang.github.io/compiler-team/>Rust Lang - Compiler Team</a></h2><style>nav ul a[href$=\2f compiler-team\2fminutes\2ftriage-meeting\2fT-compiler-Meeting-Agenda-2021-12-16\2f ]{color:#004ed0}</style><ul><li><p><strong>About</strong></p><ul><li><a href=/compiler-team/about/CODE_OF_CONDUCT/>Code of Conduct</a></li><li><a href=/compiler-team/about/chat-platform/>Chat Platform</a></li><li><a href=/compiler-team/about/steering-meeting/>Steering Meeting</a></li><li><a href=/compiler-team/about/triage-meeting/>Triage Meeting</a></li></ul></li><li><p><strong>Minutes</strong></p><ul><li><a href=/compiler-team/minutes/design-meeting/>Design Meetings</a></li><li><a href=/compiler-team/minutes/steering-meeting/>Steering Meetings</a></li><li><a href=/compiler-team/minutes/triage-meeting/>Triage Meetings</a></li></ul></li><li><p><strong>Procedures</strong></p><ul><li><a href=/compiler-team/procedures/>Documentation</a></li><li><a href=/compiler-team/procedures/crates/>Crates</a></li><li><a href=/compiler-team/procedures/call-for-participation/>Call for participation</a></li><li><a href=/compiler-team/procedures/form-new-working-group/>Form new working group</a></li></ul></li><li><p><a href=/compiler-team/working-groups/><strong>Working Groups</strong></a></p><ul><li><a href=/compiler-team/working-groups/async-await/>Async Await</a></li><li><a href=/compiler-team/working-groups/debugging/>Debugging</a></li><li><a href=/compiler-team/working-groups/diagnostics/>Diagnostics</a></li><li><a href=/compiler-team/working-groups/rustc-dev-guide/>Rustc Dev Guide</a></li><li><a href=/compiler-team/working-groups/llvm/>LLVM</a></li><li><a href=/compiler-team/working-groups/meta/>Meta</a></li><li><a href=/compiler-team/working-groups/mir-opt/>MIR-opt</a></li><li><a href=/compiler-team/working-groups/nll/>NLL</a></li><li><a href=/compiler-team/working-groups/parallel-rustc/>parallel rustc</a></li><li><a href=/compiler-team/working-groups/pgo/>PGO</a></li><li><a href=/compiler-team/working-groups/pipelining/>pipelining</a></li><li><a href=/compiler-team/working-groups/polonius/>polonius</a></li><li><a href=/compiler-team/working-groups/polymorphization/>polymorphization</a></li><li><a href=/compiler-team/working-groups/prioritization/>Prioritization</a></li><li><a href=/compiler-team/working-groups/rfc-2229/>rfc-2229</a></li><li><a href=/compiler-team/working-groups/rls-2.0/>rls-2.0</a></li><li><a href=/compiler-team/working-groups/self-profile/>Self Profile</a></li><li><a href=/compiler-team/working-groups/traits/>Traits</a></li></ul></li></ul></nav></aside><div class=book-page><header class="align-center justify-between book-header"><label for=menu-control><img src=/compiler-team/svg/menu.svg alt=Menu>
</label><strong>T Compiler Meeting Agenda 2021 12 16</strong></header><article class=markdown><h1 id=t-compiler-meeting-agenda-2021-12-16>T-compiler Meeting Agenda 2021-12-16</h1><p><a href=https://github.com/rust-lang/rust/issues/54818>Tracking Issue</a></p><h2 id=announcements>Announcements</h2><ul><li>Tomorrow <a href=time:2021-12-17T15:00:00+01:00>time:2021-12-17T15:00:00+01:00</a>, monthly <a href=https://forge.rust-lang.org/compiler/steering-meeting.html>Compiler Team Planning meeting</a></li><li>Reminder: if you see a PR/issue that seems like there might be legal implications due to copywrite/IP/etc, please let the Core team know (or at least message @<em><strong>pnkfelix</strong> or @</em><strong>Wesley Wiser</strong> so we can pass it along).</li></ul><h2 id=mcpsfcps>MCPs/FCPs</h2><ul><li>New MCPs (take a look, see if you like them!)<ul><li>No new proposals this time.</li></ul></li><li>Old MCPs (not seconded, take a look)<ul><li>&ldquo;CI should exercise (subset of) tests under &ndash;stage 1&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/439>compiler-team#439</a> (last review activity: 3 months ago)</li><li>&ldquo;Accept <code>pc</code> in place of <code>unknown</code> and <code>unknown</code> in place of <code>pc</code> for <code>x86_64</code> and <code>i?86</code> targets&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/441>compiler-team#441</a> (last review activity: 5 months ago)</li><li>&ldquo;Make <code>-Z binary-dep-depinfo</code> the default behavior&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/464>compiler-team#464</a> (last review activity: 2 months ago)</li><li>&ldquo;Tier 3 target proposal: riscv64gc-linux-android (Android target for <code>riscv64gc</code>)&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/472>compiler-team#472</a> (last review activity: about 6 days ago)</li><li>&ldquo;<code>-Dwarnings</code> to cover all warnings&rdquo; <a href=https://github.com/rust-lang/compiler-team/issues/473>compiler-team#473</a> (last review activity: about 6 days ago)</li></ul></li><li>Pending FCP requests (check your boxes!)<ul><li>&ldquo;Stabilize <code>-Z instrument-coverage</code> as <code>-C instrument-coverage</code>&rdquo; <a href=https://github.com/rust-lang/rust/pull/90132>rust#90132</a></li><li>&ldquo;Stabilize <code>-Z print-link-args</code> as <code>-C print-link-args</code>&rdquo; <a href=https://github.com/rust-lang/rust/pull/91606>rust#91606</a></li></ul></li><li>Things in FCP (make sure you&rsquo;re good with it)<ul><li>&ldquo;Tracking issue for RFC 2115: In-band lifetime bindings&rdquo; <a href=https://github.com/rust-lang/rust/issues/44524>rust#44524</a></li></ul></li><li>Accepted MCPs<ul><li>No new accepted proposals this time.</li></ul></li><li>Finalized FCPs (disposition merge)<ul><li>&ldquo;Stabilise <code>feature(const_generics_defaults)</code>&rdquo; <a href=https://github.com/rust-lang/rust/pull/90207>rust#90207</a></li><li>&ldquo;rustdoc: accept <code>--out-dir</code> and soft-deprecate <code>--output</code>&rdquo; <a href=https://github.com/rust-lang/rust/issues/91260>rust#91260</a></li></ul></li></ul><h3 id=wg-checkins>WG checkins</h3><ul><li>@<em>WG-rfc-2229</em> by @<strong>nikomatsakis</strong> @<strong>Matthew Jasper</strong> (<a href=https://hackmd.io/N_WW5tZqTLWouaed6cCjxg#WG-checkins>previous checkin</a>)<blockquote><p>Checkin text</p></blockquote></li><li>@<em>WG-rls2.0</em> by @<strong>matklad</strong> (<a href=https://hackmd.io/N_WW5tZqTLWouaed6cCjxg#WG-checkins>previous checkin</a>)<blockquote><p>Checkin text</p></blockquote></li></ul><h2 id=backport-nominations>Backport nominations</h2><p><a href="https://github.com/rust-lang/rust/issues?q=is%3Aall+label%3Abeta-nominated+-label%3Abeta-accepted+label%3AT-compiler">T-compiler stable</a> / <a href="https://github.com/rust-lang/rust/issues?q=is%3Aall+label%3Astable-nominated+-label%3Astable-accepted+label%3AT-compiler">T-compiler beta</a></p><ul><li>:beta: &ldquo;Deduplicate projection sub-obligations&rdquo; <a href=https://github.com/rust-lang/rust/pull/90423>rust#90423</a><ul><li>fixes <a href=https://github.com/rust-lang/rust/issues/91598>rust#91598</a>, a <code>P-critical</code> compile-time regression</li></ul></li><li>:beta: &ldquo;Sync portable-simd to remove autosplats&rdquo; <a href=https://github.com/rust-lang/rust/pull/91484>rust#91484</a><ul><li>PR provided by @<strong>Jubilee</strong></li><li>fixes <a href=https://github.com/rust-lang/rust/issues/90904>rust#90904</a>, <code>P-high</code> regression in libs from stable</li></ul></li><li>:beta: &ldquo;Revert setting a default for the MACOSX_DEPLOYMENT_TARGET env var for linking&rdquo; <a href=https://github.com/rust-lang/rust/pull/91870>rust#91870</a><ul><li>fixes <a href=https://github.com/rust-lang/rust/issues/91372>rust#91372</a>, a breaking change on macOS targets that prevented compiling against core crates</li></ul></li><li>:beta: &ldquo;Fix HashStable implementation on InferTy&rdquo; <a href=https://github.com/rust-lang/rust/pull/91892>rust#91892</a><ul><li>opened by @<strong>Michael Goulet</strong></li><li>fixes <a href=https://github.com/rust-lang/rust/issues/91807>rust#91807</a> a regression from stable that prevents valid code to compile in Rust 1.57</li></ul></li><li>:stable: &ldquo;Deduplicate projection sub-obligations&rdquo; <a href=https://github.com/rust-lang/rust/pull/90423>rust#90423</a><ul><li>fixes <a href=https://github.com/rust-lang/rust/issues/91598>rust#91598</a>, a <code>P-critical</code> compile-time regression</li></ul></li></ul><p><a href="https://github.com/rust-lang/rust/issues?q=is%3Aall+label%3Abeta-nominated+-label%3Abeta-accepted+label%3AT-rustdoc">T-rustdoc beta</a> / <a href="https://github.com/rust-lang/rust/issues?q=is%3Aall+label%3Astable-nominated+-label%3Astable-accepted+label%3AT-rustdoc">T-rustdoc stable</a></p><ul><li>No backport nominations for <code>T-rustdoc</code> this time.</li></ul><p>:back: / :shrug: / :hand:</p><h2 id=prs-s-waiting-on-team>PRs S-waiting-on-team</h2><p><a href="https://github.com/rust-lang/rust/pulls?utf8=%E2%9C%93&amp;q=is%3Aopen+label%3AS-waiting-on-team+label%3AT-compiler">T-compiler</a></p><ul><li>&ldquo;Stabilize <code>-Z print-link-args</code> as <code>-C print-link-args</code>&rdquo; <a href=https://github.com/rust-lang/rust/pull/91606>rust#91606</a><ul><li>@<strong>Wesley Wiser</strong> <a href=https://github.com/rust-lang/rust/pull/91606#issuecomment-992960418>proposed merge</a> of the RFC (pending one comment from @<strong>Vadim Petrochenkov</strong>)</li></ul></li></ul><h2 id=oldest-prs-waiting-for-review>Oldest PRs waiting for review</h2><p><a href="https://github.com/rust-lang/rust/pulls?q=is%3Apr+is%3Aopen+label%3AS-waiting-on-review+draft%3Afalse+label%3AT-compiler+sort%3Acreated-asc">T-compiler</a></p><ul><li>&ldquo;Fix ICE with inferred type in <code>const</code> or <code>static</code> item&rdquo; <a href=https://github.com/rust-lang/rust/pull/89161>rust#89161</a> (last review activity: about 57 days ago)<ul><li>last review from Niko</li></ul></li><li>improve type abiguity error for functions and methods <a href=https://github.com/rust-lang/rust/pull/89862>rust#89862</a> (last activity about 2 month ago)<ul><li>PR author @<strong>lcnr</strong></li><li>previously reviewed by @<strong>Esteban Küber</strong></li><li>PR seems to need another round of review</li></ul></li></ul><h2 id=issues-of-note>Issues of Note</h2><h3 id=short-summary>Short Summary</h3><ul><li><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AT-compiler+label%3AP-critical">3 T-compiler P-critical issues</a><ul><li><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AT-compiler+label%3AP-critical+no%3Aassignee">0 of those are unassigned</a></li></ul></li><li><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AT-compiler+label%3AP-high">76 T-compiler P-high issues</a><ul><li><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AT-compiler+label%3AP-high+no%3Aassignee">51 of those are unassigned</a></li></ul></li><li><a href=https://github.com/rust-lang/rust/labels/regression-from-stable-to-beta>1 P-critical, 1 P-high, 0 P-medium, 0 P-low regression-from-stable-to-beta</a></li><li><a href=https://github.com/rust-lang/rust/labels/regression-from-stable-to-nightly>0 P-critical, 1 P-high, 2 P-medium, 0 P-low regression-from-stable-to-nightly</a></li><li><a href=https://github.com/rust-lang/rust/labels/regression-from-stable-to-stable>2 P-critical, 51 P-high, 81 P-medium, 11 P-low regression-from-stable-to-stable</a></li></ul><h3 id=p-critical>P-critical</h3><p><a href="https://github.com/rust-lang/rust/issues?utf8=%E2%9C%93&amp;q=is%3Aopen+label%3AP-critical+label%3AT-compiler">T-compiler</a></p><ul><li>&ldquo;Huge compile-time regression in beta/nightly&rdquo; <a href=https://github.com/rust-lang/rust/issues/91128>rust#91128</a><ul><li>issue author mentions that disabling the new LLVM pass manager makes the regression disappear</li><li>an MCVE is <a href=https://github.com/rust-lang/rust/issues/91128#issuecomment-977154873>at this comment</a></li><li>@<strong>nikic</strong> followed up with some <a href=https://github.com/rust-lang/rust/issues/91128#issuecomment-988968103>insights</a> and an LLVM patch <a href=https://reviews.llvm.org/D115497>#D115497</a></li></ul></li><li>&ldquo;Compile-time regression between 1.56.1 and 1.57.0 for deeply nested decorator types&rdquo; <a href=https://github.com/rust-lang/rust/issues/91598>rust#91598</a><ul><li>@<strong>Aaron Hill</strong> provided a fix in PR <a href=https://github.com/rust-lang/rust/pull/90423>rust#90423</a></li><li>patch is beta- and stable-backport nominated</li></ul></li></ul><p><a href="https://github.com/rust-lang/rust/issues?utf8=%E2%9C%93&amp;q=is%3Aopen+label%3AP-critical+label%3AT-rustdoc">T-rustdoc</a></p><ul><li>No <code>P-critical</code> issues for <code>T-rustdoc</code> this time.</li></ul><h3 id=p-high-regressions>P-high regressions</h3><p><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3Aregression-from-stable-to-beta+label%3AP-high+-label%3AT-infra+-label%3AT-release+-label%3AT-rustdoc+-label%3AT-core">P-high beta regressions</a></p><ul><li>No <code>P-high</code> beta regressions this time.</li></ul><p><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3Aregression-from-stable-to-nightly+label%3AP-high+no%3Aassignee+-label%3AT-infra+-label%3AT-release+-label%3AT-rustdoc+-label%3AT-core">Unassigned P-high nightly regressions</a></p><ul><li>No unassigned <code>P-high</code> nightly regressions this time.</li></ul><h2 id=performance-logs>Performance logs</h2><blockquote><p><a href=https://github.com/rust-lang/rustc-perf/blob/master/triage/2021-12-14.md>triage logs 2021-12-14</a></p></blockquote><p>This week&rsquo;s report started with 6 regressions; after eliminating truly obvious noise, we are left with just 2 minor regressions. Of the cases that regressed, I think the only interesting one is keccak (regressed by 1.73% in PR #91549). But don&rsquo;t be too depressed: keccak was also improved up to 23% by PR <a href=https://github.com/rust-lang/rust/pull/85013>#85013</a> (!); thanks to @<strong>simulacrum</strong> for that PR.</p><p>Triage done by <strong>@pnkfelix</strong>.
Revision range: <a href="https://perf.rust-lang.org/?start=e2116acae59654bfab2a9729a024f3e2fd6d4b02&amp;end=404c8471aba60c2d837fa728e7c729a0f52d5830&amp;absolute=false&amp;stat=instructions%3Au">e2116acae59654bfab2a9729a024f3e2fd6d4b02..404c8471aba60c2d837fa728e7c729a0f52d5830</a></p><p>2 Regressions, 5 Improvements, 3 Mixed; 1 of them in rollups
30 Untriaged pull-requests
48 comparisons made in total</p><h4 id=regressions>Regressions</h4><p>&ldquo;Support AVR for inline asm!&rdquo; <a href=https://github.com/rust-lang/rust/issues/91224>#91224</a></p><ul><li>Moderate regression in <a href="https://perf.rust-lang.org/compare.html?start=c5c94945096265b6d675b2f55a247c4799de8d87&amp;end=0b6f079e4987ded15c13a15b734e7cfb8176839f&amp;stat=instructions:u">instruction counts</a> (up to 0.8% on <code>incr-unchanged</code> builds of <code>externs</code>)</li><li>This regression is solely isolated to variants of the <code>externs</code> benchmark.</li><li>It seems like a near certainty that the regression reported here is noise exacerbated by this pathological benchmark.</li><li>Marked as triaged.</li></ul><p>&ldquo;Eliminate ConstnessAnd again&rdquo; <a href=https://github.com/rust-lang/rust/issues/91549>#91549</a></p><ul><li>Large regression in <a href="https://perf.rust-lang.org/compare.html?start=6bda5b331cfe7e04e1fe348c58a928fc2b650f4f&amp;end=22f8bde876f2fa9c5c4e95be1bce29cc271f2b51&amp;stat=instructions:u">instruction counts</a> (up to 3.1% on <code>full</code> builds of <code>inflate</code>)</li><li>This PR went through many rounds of performance evaluation and tuning.</li><li>The only &ldquo;real&rdquo; regressions are likely to be <code>inflate</code> and <code>keccak</code>, and I am suspicious of <code>inflate</code> based on its sensitivity in other PR&rsquo;s.</li><li>I&rsquo;m leaving this PR in this week&rsquo;s report largely just to draw attention to the problem we face in trying to evalute impact of cases like this.</li></ul><h4 id=improvements>Improvements</h4><ul><li>&ldquo;Avoid string validation in rustc_serialize, check a marker byte instead&rdquo; <a href=https://github.com/rust-lang/rust/issues/91407>#91407</a></li><li>&ldquo;Sync portable-simd to remove autosplats&rdquo; <a href=https://github.com/rust-lang/rust/issues/91484>#91484</a></li><li>&ldquo;replace vec::Drain drop loops with drop_in_place&rdquo; <a href=https://github.com/rust-lang/rust/issues/85157>#85157</a></li><li>&ldquo;replace dynamic library module with libloading&rdquo; <a href=https://github.com/rust-lang/rust/issues/90716>#90716</a></li><li>&ldquo;manually implement Hash for DefId&rdquo; <a href=https://github.com/rust-lang/rust/issues/91660>#91660</a></li></ul><h4 id=mixed>Mixed</h4><p>&ldquo;Replace dominators algorithm with simple Lengauer-Tarjan&rdquo; <a href=https://github.com/rust-lang/rust/issues/85013>#85013</a></p><ul><li>Very large improvement in <a href="https://perf.rust-lang.org/compare.html?start=2af5c6562deed1878000e791f2cb21b981a53959&amp;end=c67497a5da33eb3167a33e938920ce04d2b883a5&amp;stat=instructions:u">instruction counts</a> (up to -23.6% on <code>full</code> builds of <code>keccak</code>)</li><li>Small regression in <a href="https://perf.rust-lang.org/compare.html?start=2af5c6562deed1878000e791f2cb21b981a53959&amp;end=c67497a5da33eb3167a33e938920ce04d2b883a5&amp;stat=instructions:u">instruction counts</a> (up to 0.4% on <code>incr-unchanged</code> builds of <code>helloworld</code>)</li></ul><p>&ldquo;Rollup of 6 pull requests&rdquo; <a href=https://github.com/rust-lang/rust/issues/91799>#91799</a></p><ul><li>Very large improvement in <a href="https://perf.rust-lang.org/compare.html?start=b8dc6aa673317cf72a8abb9c421f573f2b34b47a&amp;end=928783de663bd855a96f14b2d38c1061603587c6&amp;stat=instructions:u">instruction counts</a> (up to -5.9% on <code>incr-unchanged</code> builds of <code>inflate</code>)</li><li>Small regression in <a href="https://perf.rust-lang.org/compare.html?start=b8dc6aa673317cf72a8abb9c421f573f2b34b47a&amp;end=928783de663bd855a96f14b2d38c1061603587c6&amp;stat=instructions:u">instruction counts</a> (up to 0.8% on <code>incr-unchanged</code> builds of <code>issue-88862</code>)</li><li>I don&rsquo;t yet now hat&rsquo;s up with the regression here to issue-88862.</li></ul><p>&ldquo;Deduplicate projection sub-obligations&rdquo; <a href=https://github.com/rust-lang/rust/issues/90423>#90423</a></p><ul><li>Very large improvement in <a href="https://perf.rust-lang.org/compare.html?start=a0a4c7d1e48c39a73119eb9107d402d60c83293b&amp;end=4c9bdf4cbbf1deab0b5da398d4910558a66b332f&amp;stat=instructions:u">instruction counts</a> (up to -6.2% on <code>full</code> builds of <code>deeply-nested</code>)</li><li>Small regression in <a href="https://perf.rust-lang.org/compare.html?start=a0a4c7d1e48c39a73119eb9107d402d60c83293b&amp;end=4c9bdf4cbbf1deab0b5da398d4910558a66b332f&amp;stat=instructions:u">instruction counts</a> (up to 0.5% on <code>full</code> builds of <code>regression-31157</code>)</li><li>This is a targetted fix to address performance regressons that leaked into 1.57. It has been beta-nominated for backport.</li></ul><h2 id=nominated-issues>Nominated Issues</h2><p><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AI-compiler-nominated">T-compiler</a></p><ul><li>&ldquo;Disable LLVM newPM by default&rdquo; <a href=https://github.com/rust-lang/rust/pull/91190>rust#91190</a><ul><li>mentioned in past meeting, scheduled to be re-evaluated again this week (<a href=https://github.com/rust-lang/rust/pull/91190#issuecomment-984738762>see comment</a>) and relevant <a href=https://rust-lang.zulipchat.com/#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-12-02.20.2354818/near/263454357>Zulip discussion</a></li><li>@<strong>Nikita Popov</strong> has a patch <a href=https://reviews.llvm.org/D115497>for LLVM</a> (see relevant <a href=https://github.com/rust-lang/rust/issues/91128#issuecomment-990064382>comment with some context</a>)</li></ul></li></ul><p><a href="https://github.com/rust-lang/rfcs/issues?q=is%3Aopen+label%3AI-nominated+label%3AT-compiler">RFC</a></p><ul><li>No nominated RFCs for <code>T-compiler</code> this time.</li></ul></article></div><aside class="book-toc level-6 fixed"><nav id=TableOfContents><ul><li><a href=#announcements>Announcements</a></li><li><a href=#mcpsfcps>MCPs/FCPs</a><ul><li><a href=#wg-checkins>WG checkins</a></li></ul></li><li><a href=#backport-nominations>Backport nominations</a></li><li><a href=#prs-s-waiting-on-team>PRs S-waiting-on-team</a></li><li><a href=#oldest-prs-waiting-for-review>Oldest PRs waiting for review</a></li><li><a href=#issues-of-note>Issues of Note</a><ul><li><a href=#short-summary>Short Summary</a></li><li><a href=#p-critical>P-critical</a></li><li><a href=#p-high-regressions>P-high regressions</a></li></ul></li><li><a href=#performance-logs>Performance logs</a><ul><li></li></ul></li><li><a href=#nominated-issues>Nominated Issues</a></li></ul></nav></aside></main></body></html>