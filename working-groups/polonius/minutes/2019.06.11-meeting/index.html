<!doctype html><html lang=en><head><meta http-equiv=refresh content="0; url=https://forge.rust-lang.org/compiler/index.html"></head><body><input type=checkbox style=display:none id=menu-control><main class="flex container"><aside class="book-menu fixed"><nav><h2 class=book-brand><a href=https://rust-lang.github.io/compiler-team/>Rust Lang - Compiler Team</a></h2><style>nav ul a[href$="\2f compiler-team\2fworking-groups\2fpolonius\2fminutes\2f 2019.06.11-meeting\2f "]{color:#004ed0}</style><ul><li><p><strong>About</strong></p><ul><li><a href=/compiler-team/about/CODE_OF_CONDUCT/>Code of Conduct</a></li><li><a href=/compiler-team/about/chat-platform/>Chat Platform</a></li><li><a href=/compiler-team/about/steering-meeting/>Steering Meeting</a></li><li><a href=/compiler-team/about/triage-meeting/>Triage Meeting</a></li></ul></li><li><p><strong>Minutes</strong></p><ul><li><a href=/compiler-team/minutes/design-meeting/>Design Meetings</a></li><li><a href=/compiler-team/minutes/steering-meeting/>Steering Meetings</a></li><li><a href=/compiler-team/minutes/triage-meeting/>Triage Meetings</a></li></ul></li><li><p><strong>Procedures</strong></p><ul><li><a href=/compiler-team/procedures/>Documentation</a></li><li><a href=/compiler-team/procedures/crates/>Crates</a></li><li><a href=/compiler-team/procedures/call-for-participation/>Call for participation</a></li><li><a href=/compiler-team/procedures/form-new-working-group/>Form new working group</a></li></ul></li><li><p><a href=/compiler-team/working-groups/><strong>Working Groups</strong></a></p><ul><li><a href=/compiler-team/working-groups/async-await/>Async Await</a></li><li><a href=/compiler-team/working-groups/debugging/>Debugging</a></li><li><a href=/compiler-team/working-groups/diagnostics/>Diagnostics</a></li><li><a href=/compiler-team/working-groups/rustc-dev-guide/>Rustc Dev Guide</a></li><li><a href=/compiler-team/working-groups/llvm/>LLVM</a></li><li><a href=/compiler-team/working-groups/meta/>Meta</a></li><li><a href=/compiler-team/working-groups/mir-opt/>MIR-opt</a></li><li><a href=/compiler-team/working-groups/nll/>NLL</a></li><li><a href=/compiler-team/working-groups/parallel-rustc/>parallel rustc</a></li><li><a href=/compiler-team/working-groups/pgo/>PGO</a></li><li><a href=/compiler-team/working-groups/pipelining/>pipelining</a></li><li><a href=/compiler-team/working-groups/polonius/>polonius</a></li><li><a href=/compiler-team/working-groups/polymorphization/>polymorphization</a></li><li><a href=/compiler-team/working-groups/prioritization/>Prioritization</a></li><li><a href=/compiler-team/working-groups/rfc-2229/>rfc-2229</a></li><li><a href=/compiler-team/working-groups/rls-2.0/>rls-2.0</a></li><li><a href=/compiler-team/working-groups/self-profile/>Self Profile</a></li><li><a href=/compiler-team/working-groups/traits/>Traits</a></li></ul></li></ul></nav></aside><div class=book-page><header class="align-center justify-between book-header"><label for=menu-control><img src=/compiler-team/svg/menu.svg alt=Menu>
</label><strong>WG-Polonius meeting minutes 2019.06.11</strong></header><article class=markdown><h1 id=wg-polonius-meeting-minutes-20190611>WG-Polonius meeting minutes: 2019/06/11</h1><p>Relevant links:</p><ul><li>The meeting happened in this <a href=https://rust-lang.zulipchat.com/#narrow/stream/186049-t-compiler.2Fwg-polonius/topic/meeting.202019.2E06.2E11>Zulip thread</a>.</li><li>The <a href=https://paper.dropbox.com/doc/Polonius-Roadmap--AY6C806s~AZK~e7wagmys2_wAg-hk3a9ynduUN2gk1A0NNTF>WIP Roadmap</a> Paper.</li></ul><hr><p>This week, we worked on — and discussed — the following topics:</p><h3 id=1-proposal-stop-tracking-subset-relations-along-the-cfg>1. Proposal: stop tracking subset relations along the CFG</h3><p><a href=https://github.com/nikomatsakis>Niko</a> wrote up an issue with more details about the proposal: <a href=https://github.com/rust-lang/polonius/issues/107>issue #107</a>. We also discussed it more in the dedicated zulip thread, around <a href=https://rust-lang.zulipchat.com/#narrow/stream/186049-t-compiler.2Fwg-polonius/topic/subset.20relations.20and.20polonius/near/167407904>this point</a>.</p><p>We made an example where the new refinement would improve on Polonius&rsquo; behaviour: it currently flags an unnecessary error on <a href="https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2018&amp;gist=52fbcbf0fdf3c55542476842053994a6">this example</a>.</p><p><a href=https://github.com/nikomatsakis>Niko</a> later <a href=https://github.com/rust-lang/polonius/issues/107#issuecomment-499427026>realized</a> that the refinement as proposed could also be less precise than current Polonius (which accepts the example in the comment), and which could require making the <code>equality</code>-tracking flow-sensitive.</p><p>Some more exploratory work is planned around these refinements, and also around their interaction with other topics: for example &ldquo;illegal subset relation errors&rdquo; would likely need an approach similar to the &ldquo;placeholder loans&rdquo; we discussed <a href=https://rust-lang.zulipchat.com/#narrow/stream/122657-t-compiler.2Fwg-nll/topic/polonius/near/152599003>around here</a>, and prior to that, <a href=https://rust-lang.zulipchat.com/#narrow/stream/122657-t-compiler.2Fwg-nll/topic/polonius.20subset.20considered.20unnecessary/near/148870693>here</a>.</p><p>To prepare for the call on this topic, <a href=https://github.com/lqd>Rémy</a> tried implementing a quick <a href=https://github.com/rust-lang/polonius/compare/master...lqd:variant_prototype>prototype and examples</a>. As of this writing, it seems to work on the simpler example datasets from the Polonius repository, but not on the more realisic use-case (<code>clap</code>) so more bugfixing will be needed. <a href=https://github.com/lqd>Rémy</a> also wrote a <a href=https://hackmd.io/EqECXcd7TIGj97lVNc4dhw?view>short report</a> about those quick explorations.</p><h3 id=2-call-about-subset-relations-the-proposal-oxide>2. Call about <code>subset</code> relations, the proposal, Oxide</h3><p>We had a <a href="https://www.youtube.com/watch?v=mAUGvNgZYtw">recorded video call</a> about the specifics of the <code>subset</code> relation, its role and why it was propagated along the CFG. We then talked in more detail about the proposal refinement(s), and finished with a comparison between the Polonius model and the Oxide model.</p><p>To follow along the video: the paper document we used to record notes and examples can be <a href=https://paper.dropbox.com/doc/Polonius-and-subset-propagation--AemU19yUmQ461DupzxgaCj2NAg-2uMIPkQSbqpPjqrJ9L9DM>found here</a>.</p><p>Huge thanks to everyone involved, it was super interesting and fun!</p><h3 id=3-profiling-and-performance>3. Profiling and performance</h3><p><a href=https://github.com/lokalmatador>@lokalmatador</a> has been successfully gathering early results :tada: (for example, <a href=https://rust-lang.zulipchat.com/user_uploads/4715/C7fHB1wgXXWWxNrd1N8sbRy1/measurements.zip>this profiling data</a> comes from some of examples in the Polonius repository). The next steps will then be to collect some data from the official rustc benchmarking suite.</p><h3 id=4-rustc-test-failures-under-polonius>4. Rustc test failures under Polonius</h3><p><a href=https://github.com/lqd>Rémy</a> has (slowly) continued work on analyzing the <code>ui</code> test suite failures under Polonius. Now that <a href=https://github.com/matthewjasper>Matthew</a>&rsquo;s <a href=https://github.com/rust-lang/rust/pull/60171>PR #60171</a> has landed: the WIP branch was rebased into a more stable state.</p><p>New failures were unfortunately found, but most of the simpler differences were &ldquo;taken care of&rdquo;. The analysis will need to be double-checked, and the WIP report is <a href=https://hackmd.io/CjYB0fs4Q9CweyeTdKWyEg?view>here</a>.</p><p>There are still a couple of simple cases left (differences in diagnostics only, for example) before looking at the remaining more complicated cases, but those seem to be actual &ldquo;regressions&rdquo; somewhere (probably divergences between the Polonius facts, NLL constraints, and assumptions about MIR).</p><h3 id=5-liveness>5. Liveness</h3><p>:tada: <a href=https://github.com/rust-lang/polonius/pull/105>polonius#105</a> has landed :tada:</p><p>Now, to get the <a href=https://github.com/rust-lang/rust/pull/60266/>rustc changes</a> landed, we were still wondering about the differences between the <code>region_live_at</code> facts computed by rustc, and the ones computed by Polonius. The liveness computation in rustc is taking initialization into account, while rustc PR #60266 only slightly (which is expected as move/initialization analysis is the next item <a href=https://github.com/albins>Albin</a> plans to tackle).</p><p><a href=https://github.com/nikomatsakis>Niko</a> and <a href=https://github.com/albins>Albin</a> discussed (<a href=https://rust-lang.zulipchat.com/#narrow/stream/186049-t-compiler.2Fwg-polonius/topic/liveness.20polonius.23104/near/167883671>around here</a>) a way to remove the computation of the <code>region_live_at</code> relation without losing precision, as both a safety measure and an intermediary step towards handling moves/initialization.</p><hr><p>With <a href=https://github.com/nikomatsakis>Niko</a> being away at Mozilla All Hands next week, we mentioned that we might do short async updates instead of a sync meeting, but the plan was overall:</p><ul><li><a href=https://github.com/lokalmatador>@lokalmatador</a> will continue gathering profiling data.</li><li><a href=https://github.com/albins>Albin</a> will look at the potential <code>region_live_at</code> intermediary step we mentioned.</li><li><a href=https://github.com/lqd>Rémy</a> will continue on the rustc test suite analysis, and the proposal prototype.</li></ul></article></div><aside class="book-toc level-6 fixed"><nav id=TableOfContents><ul><li><ul><li><a href=#1-proposal-stop-tracking-subset-relations-along-the-cfg>1. Proposal: stop tracking subset relations along the CFG</a></li><li><a href=#2-call-about-subset-relations-the-proposal-oxide>2. Call about <code>subset</code> relations, the proposal, Oxide</a></li><li><a href=#3-profiling-and-performance>3. Profiling and performance</a></li><li><a href=#4-rustc-test-failures-under-polonius>4. Rustc test failures under Polonius</a></li><li><a href=#5-liveness>5. Liveness</a></li></ul></li></ul></nav></aside></main></body></html>